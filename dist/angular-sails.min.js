!function(r,n){"use strict";r.module("ngSails",["ngSails.$sails","ngSails.$sailsInterceptor"]),r.module("ngSails.$sailsInterceptor",[]).provider("$sailsInterceptor",function(){var n=this.interceptors=[],t=this.responseInterceptors=[];this.$get=["$q","$timeout","$injector",function(e,s,o){var i=[];r.forEach(n,function(n){i.unshift(r.isString(n)?o.get(n):o.invoke(n))}),r.forEach(t,function(n,t){var s=r.isString(n)?o.get(n):o.invoke(n);i.splice(t,0,{response:function(r){return s(e.when(r))},responseError:function(r){return s(e.reject(r))}})});var u=function(n,t){var s=[n,void 0],o=e.when(t);for(r.forEach(i,function(r){(r.request||r.requestError)&&s.unshift(r.request,r.requestError),(r.response||r.responseError)&&s.push(r.response,r.responseError)});s.length;){var u=s.shift(),c=s.shift();o=o.then(u,c)}return o};return u}]}),r.module("ngSails.$sails",["ngSails.$sailsInterceptor"]).provider("$sails",["$sailsInterceptorProvider",function(t){var e=this,s=["get","post","put","delete"],o=["on","once"];this.url=void 0,this.interceptors=t.interceptors,this.responseInterceptors=t.responseInterceptors,this.$get=["$q","$timeout","$sailsInterceptor",function(t,i,u){var c=n.connect(e.url),a=function(r,n){i(function(){r(n)})},l=function(n){c["legacy_"+n]=c[n],c[n]=function(e,s,o){function i(e){var s=t.defer();return c["legacy_"+n](e.url,e.data,function(n){n&&r.isObject(n)&&n.status&&2!==Math.floor(n.status/100)?s.reject(n):s.resolve(n)}),s.promise}void 0===o&&r.isFunction(s)&&(o=s,s=null);var a=u(i,{url:e,data:s});return a=a.then(o,null),a.success=function(r){return a.then(r),a},a.error=function(r){return a.then(null,r),a},a}},f=function(n){c["legacy_"+n]=c[n],c[n]=function(t,e){null!==e&&r.isFunction(e)&&c["legacy_"+n](t,function(r){a(e,r)})}};return r.forEach(s,l),r.forEach(o,f),c}]}])}(angular,io);